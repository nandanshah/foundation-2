create keyspace if not exists fis with replication = { 'class' : 'SimpleStrategy', 'replication_factor' : 1 };
use fis;
create table if not exists eo_spark_app_prop(sparkappname text, properties map<text,text>, primary key (sparkappname));
insert into eo_spark_app_prop(sparkappname,properties) values('userevent',{'event_required':'WATCH,60,10|Like,40|Rate,1#-25:2#-10:3#50:4#75:5#100','input_date':'2014-06-29','recalculation_start_date':'2014-06-26','recalculation_end_date':'2014-06-29','recalculation_period':'5','incremental_flag':'false'});
insert into eo_spark_app_prop(sparkappname,properties) values('dailyeventsummary',{'input_date':'2014-06-29','recalculation_start_date':'2014-06-26','recalculation_end_date':'2014-06-29','recalculation_period':'5','incremental_flag':'false'});
insert into eo_spark_app_prop(sparkappname,properties) values('trendscore',{'current_trend_date':'2014-06-26','recalculation_start_date':'2014-06-26','recalculation_end_date':'2014-06-29','zscore_period':'30','incremental_flag':'false'});
create table if not exists userevent(id uuid, tenantid uuid, regionid uuid , profileid uuid, itemid uuid,accountid uuid,localeid uuid,deviceid uuid,sessionid uuid, eventtype text,timestamp bigint,devicetype text,searchtype text,searchstring text,resultpagenumber int,useraction text,rankofitem int,sourceofimpression text,playpercentage double,rentStartTimeStamp bigint,rentEndTimeStamp bigint,purchaseStartTimeStamp bigint, attributevaluepair map<text,varchar>, eventrequired int,date timestamp,ratescore double ,searchfilters map<text,varchar>,primary key (id,tenantid,regionid, profileid,itemid));
create index if not exists fisusereventeventrequired on userevent (eventrequired);
create index if not exists fisusereventdate on userevent (date);
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date) values (C979CA35-B58D-434B-B2D6-EA0316BCC9A2,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'like',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,1,'2014-06-30'); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (0BA3ECD3-51A8-4B52-BDC0-00C628649B4D,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'0'},1,'2014-06-30',0); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (8EB93354-1B9E-4BB9-B87A-E113D02986F5,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'20'},1,'2014-06-30',20); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (B1758CC6-5E43-4C64-AA88-3A858F31580A,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'40'},1,'2014-06-30',40); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (D4AF16CB-693A-4C67-9942-354E285CA3A0,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'60'},1,'2014-06-30',60); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (9860C64E-628A-411E-8489-BD1E8DE1E793,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'80'},1,'2014-06-30',80); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (B526E86D-94DA-426C-B83B-7D5676F4FB1B,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'100'},1,'2014-06-30',100);
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date) values (C979CA35-B58D-434B-B2D6-EA0316BCC7A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A2,'like',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,1,'2014-06-29'); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date) values (C979CA35-B58D-434B-B2D6-EA0316BCC7A2,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'like',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,1,'2014-06-29'); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (BC0E9446-BF8D-4164-9E3F-2B7B11997A5F,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'0'},1,'2014-06-29',0); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (3A8EDA55-6A88-4020-9503-E9B8C16904AD,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'20'},1,'2014-06-29',20); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (6F618370-3B0E-48CF-881E-686607D078D9,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'40'},1,'2014-06-29',40); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (1E8174AD-5F6C-4E52-87E2-F881C8B9C835,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'60'},1,'2014-06-29',60); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (1F677B99-A52A-4465-8ACA-4F1929E090BC,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'80'},1,'2014-06-29',80); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (EC17BDCD-A6FA-467E-9199-904D7DDB970E,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'100'},1,'2014-06-29',100); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (BC0E9446-BF8D-4164-9E3F-2B7B11997A4F,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC121,1404029999,{'watchperc':'0'},1,'2014-06-29',0); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (3A8EDA55-6A88-4020-9503-E9B8C16904BD,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC121,1404029999,{'watchperc':'20'},1,'2014-06-29',20); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (6F618370-3B0E-48CF-881E-686607D078C9,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC121,1404029999,{'watchperc':'40'},1,'2014-06-29',40); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (1E8174AD-5F6C-4E52-87E2-F881C8B9C825,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC121,1404029999,{'watchperc':'60'},1,'2014-06-29',60); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (1F677B99-A52A-4465-8ACA-4F1929E090AC,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC121,1404029999,{'watchperc':'80'},1,'2014-06-29',80); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (EC17BDCD-A6FA-467E-9199-904D7DDB979E,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC121,1404029999,{'watchperc':'100'},1,'2014-06-29',100); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date) values (C979CA35-B58D-434B-B2D6-AA0316BCC9A2,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,'like',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403911596,1,'2014-06-28'); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (0BA3ECD3-51A8-4B52-BDC0-A0C628649B4D,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403911596,{'watchperc':'0'},1,'2014-06-28',0); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (8EB93354-1B9E-4BB9-B87A-A113D02986F5,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403911596,{'watchperc':'20'},1,'2014-06-28',20); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (B1758CC6-5E43-4C64-AA88-AA858F31580A,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403911596,{'watchperc':'40'},1,'2014-06-28',40); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (D4AF16CB-693A-4C67-9942-A54E285CA3A0,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403911596,{'watchperc':'60'},1,'2014-06-28',60); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (9860C64E-628A-411E-8489-AD1E8DE1E793,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403911596,{'watchperc':'80'},1,'2014-06-28',80); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (B526E86D-94DA-426C-B83B-AD5676F4FB1B,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403911596,{'watchperc':'100'},1,'2014-06-28',100);
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date) values (C979CA35-B58D-434B-B2D6-AA0316BCC7A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A4,'like',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403911596,1,'2014-06-28'); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date) values (C979CA35-B58D-434B-B2D6-AA6316BCC7A2,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A5,'like',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403911596,1,'2014-06-28'); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (BC0E9446-BF8D-4164-9E3F-AB7B11997A5F,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A5,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403925196,{'watchperc':'0'},1,'2014-06-28',0); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (3A8EDA55-6A88-4020-9503-A9B8C16904AD,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A5,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403925196,{'watchperc':'20'},1,'2014-06-28',20); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (6F618370-3B0E-48CF-881E-A86607D078D9,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A5,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403925196,{'watchperc':'40'},1,'2014-06-28',40); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (1E8174AD-5F6C-4E52-87E2-A881C8B9C835,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A5,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403925196,{'watchperc':'60'},1,'2014-06-28',60); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (1F677B99-A52A-4465-8ACA-AF1929E090BC,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A5,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403925196,{'watchperc':'80'},1,'2014-06-28',80); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (EC17BDCD-A6FA-467E-9199-A04D7DDB970E,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A5,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403925196,{'watchperc':'100'},1,'2014-06-28',100); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (BC0E9446-BF8D-4164-9E3F-AB7B11997A4F,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A6,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403929999,{'watchperc':'0'},1,'2014-06-28',0); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (3A8EDA55-6A88-4020-9503-A9B8C16904BD,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A6,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403929999,{'watchperc':'20'},1,'2014-06-28',20); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (6F618370-3B0E-48CF-881E-A86607D078C9,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A6,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403929999,{'watchperc':'40'},1,'2014-06-28',40); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (1E8174AD-5F6C-4E52-87E2-A881C8B9C825,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A6,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403929999,{'watchperc':'60'},1,'2014-06-28',60); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (1F677B99-A52A-4465-8ACA-AF1929E090AC,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A6,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403929999,{'watchperc':'80'},1,'2014-06-28',80); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (EC17BDCD-A6FA-467E-9199-A04D7DDB979E,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A6,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403929999,{'watchperc':'100'},1,'2014-06-28',100); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date) values (C979CA35-B58D-434B-B2D6-B10316BCC7A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A7,'like',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403811596,1,'2014-06-27'); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date) values (C979CA35-B58D-434B-B2D6-B10316BCC7A2,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A9,'like',C979CA35-B58D-434B-B2D6-EA0316BCC121,1403811596,1,'2014-06-27');
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date) values (C979CA35-B58D-434B-B2D6-B10316BCC7A2,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A9,'like',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403811596,1,'2014-06-27'); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (BC0E9446-BF8D-4164-9E3F-B17B11997A5F,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A9,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403825196,{'watchperc':'0'},1,'2014-06-27',0); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (3A8EDA55-6A88-4020-9503-B1B8C16904AD,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A9,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403825196,{'watchperc':'20'},1,'2014-06-27',20); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (6F618370-3B0E-48CF-881E-B16607D078D9,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A9,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403825196,{'watchperc':'40'},1,'2014-06-27',40); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (1E8174AD-5F6C-4E52-87E2-B181C8B9C835,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A9,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403825196,{'watchperc':'60'},1,'2014-06-27',60); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (1F677B99-A52A-4465-8ACA-B11929E090BC,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A9,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403825196,{'watchperc':'80'},1,'2014-06-27',80); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (EC17BDCD-A6FA-467E-9199-B14D7DDB970E,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A9,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403825196,{'watchperc':'100'},1,'2014-06-27',100); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date) values (C979CA35-B58D-434B-B2D6-BB0316BCC7A2,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC911,'like',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403811596,1,'2014-06-26'); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date) values (C979CA35-B58D-434B-B2D6-BB0316BCC7A2,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC912,'like',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403811596,1,'2014-06-26'); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date,ratescore) values (C979CA35-B58D-434B-B2D6-BB0316BC11A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC912,'rate',C979CA35-B58D-434B-B2D6-EA0316BCC121,1403811596,1,'2014-06-26',4); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date,ratescore) values (C979CA35-B58D-434B-B2D6-BB0316BC11A2,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC911,'rate',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403811596,1,'2014-06-27',2); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date,ratescore) values (C979CA35-B58D-434B-B2D6-BB0316BC11A3,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC912,'rate',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403811596,1,'2014-06-28',1); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date,ratescore) values (C979CA35-B58D-434B-B2D6-BB0316BC11A4,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC911,'rate',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403811596,1,'2014-06-29',3); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date,ratescore) values (C979CA35-B58D-434B-B2D6-BB0316BC11A5,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC912,'rate',C979CA35-B58D-434B-B2D6-EA0316BCC122,1403811596,1,'2014-06-26',5); 
create table if not exists common_daily_eventsummary_per_useritem(periodid timeuuid ,tenantid uuid,regionid uuid,itemid uuid,profileid uuid,eventtypeaggregate  map<text,double>,dayscore double,date timestamp,eventrequired int,primary key (periodid,tenantid,regionid,itemid,profileid));
create index if not exists index_common_daily_eventsummary_per_useritem_event_required on common_daily_eventsummary_per_useritem (eventrequired);
create index if not exists index_common_daily_eventsummary_per_useritem_date on common_daily_eventsummary_per_useritem (date);
create table if not exists trend_daily_eventsummary(periodid timeuuid ,tenantid uuid,regionid uuid,itemid uuid,eventtypeaggregate  map<text,double>,dayscore double,date timestamp,eventrequired int,primary key (periodid,tenantid,regionid,itemid));
create index if not exists index_trend_daily_eventsummary_event_required on trend_daily_eventsummary (eventrequired);
create index if not exists index_trend_daily_eventsummary_date on trend_daily_eventsummary (date);
create table if not exists trend_reco(id timeuuid,tenantid uuid,regionid uuid,itemid uuid,trendscore double,normalizedtrendscore double,trendscorereason text,eventrequired int,date timestamp, primary key (id,tenantid,regionid,itemid));
create index if not exists index_trend_reco_event_required on trend_reco (eventrequired);
create index if not exists index_trend_reco_date on trend_reco (date);