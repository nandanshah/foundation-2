drop keyspace IF EXISTS sampletrendrecotest3;
CREATE KEYSPACE IF NOT EXISTS sampletrendrecotest3 WITH replication = {'class':'SimpleStrategy', 'replication_factor':1};
use sampletrendrecotest3;
create table usereventsummary (id uuid, tenantid uuid, regionid uuid , userid uuid, movieid uuid, eventtype uuid,  sessionid uuid,  timestamp bigint, avp map<text,varchar>, flag int,date timestamp,primary key (id,tenantid, regionid, userid, movieid));
CREATE INDEX sampletrendrecousereventsummaryflag ON usereventsummary (flag);
CREATE INDEX sampletrendrecousereventsummarydate ON usereventsummary (date);
insert into usereventsummary(id,tenantid,regionid,userid, eventtype, movieid,timestamp,flag,date) values (C979CA35-B58D-434B-B2D6-EA0316BCC9A2,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,1,'2014-06-30'); 
insert into usereventsummary(id,tenantid,regionid,userid, eventtype, movieid,timestamp,avp,flag,date) values (0BA3ECD3-51A8-4B52-BDC0-00C628649B4D,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'0'},1,'2014-06-30'); 
insert into usereventsummary(id,tenantid,regionid,userid, eventtype, movieid,timestamp,avp,flag,date) values (8EB93354-1B9E-4BB9-B87A-E113D02986F5,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'20'},1,'2014-06-30'); 
insert into usereventsummary(id,tenantid,regionid,userid, eventtype, movieid,timestamp,avp,flag,date) values (B1758CC6-5E43-4C64-AA88-3A858F31580A,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'40'},1,'2014-06-30'); 
insert into usereventsummary(id,tenantid,regionid,userid, eventtype, movieid,timestamp,avp,flag,date) values (D4AF16CB-693A-4C67-9942-354E285CA3A0,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'60'},1,'2014-06-30'); 
insert into usereventsummary(id,tenantid,regionid,userid, eventtype, movieid,timestamp,avp,flag,date) values (9860C64E-628A-411E-8489-BD1E8DE1E793,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'80'},1,'2014-06-30'); 
insert into usereventsummary(id,tenantid,regionid,userid, eventtype, movieid,timestamp,avp,flag,date) values (B526E86D-94DA-426C-B83B-7D5676F4FB1B,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'100'},1,'2014-06-30');
insert into usereventsummary(id,tenantid,regionid,userid, eventtype, movieid,timestamp,avp,flag,date) values (BC0E9446-BF8D-4164-9E3F-2B7B11997A5F,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'0'},1,'2014-06-29'); 
insert into usereventsummary(id,tenantid,regionid,userid, eventtype, movieid,timestamp,avp,flag,date) values (3A8EDA55-6A88-4020-9503-E9B8C16904AD,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'20'},1,'2014-06-29'); 
insert into usereventsummary(id,tenantid,regionid,userid, eventtype, movieid,timestamp,avp,flag,date) values (6F618370-3B0E-48CF-881E-686607D078D9,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'40'},1,'2014-06-29'); 
insert into usereventsummary(id,tenantid,regionid,userid, eventtype, movieid,timestamp,avp,flag,date) values (1E8174AD-5F6C-4E52-87E2-F881C8B9C835,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'60'},1,'2014-06-29'); 
insert into usereventsummary(id,tenantid,regionid,userid, eventtype, movieid,timestamp,avp,flag,date) values (1F677B99-A52A-4465-8ACA-4F1929E090BC,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'80'},1,'2014-06-29'); 
insert into usereventsummary(id,tenantid,regionid,userid, eventtype, movieid,timestamp,avp,flag,date) values (EC17BDCD-A6FA-467E-9199-904D7DDB970E,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,C979CA35-B58D-434B-B2D6-EA0316BCC9A3,C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'100'},1,'2014-06-29'); 
create table dailyeventsummaryperuseritem(periodid timeuuid ,tenantid uuid,regionid uuid,itemid uuid,userid uuid,eventtypeaggregate  map<uuid,int>,dayscore double,date timestamp,flag int,primary key (periodid,tenantid,regionid,itemid,userid));