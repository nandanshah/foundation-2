drop keyspace IF EXISTS sampletrendrecotest3;
CREATE KEYSPACE IF NOT EXISTS sampletrendrecotest3 WITH replication = {'class':'SimpleStrategy', 'replication_factor':1};
use sampletrendrecotest3;
create table if not exists userevent(id uuid, tenantid uuid, regionid uuid , profileid uuid, itemid uuid,accountid uuid,localeid uuid,deviceid uuid,sessionid uuid, eventtype text,timestamp bigint,devicetype text,searchtype text,searchstring text,resultpagenumber int,useraction text,rankofitem int,sourceofimpression text,playpercentage double,rentStartTimeStamp bigint,rentEndTimeStamp bigint,purchaseStartTimeStamp bigint, attributevaluepair map<text,varchar>, eventrequired int,date timestamp,ratescore int ,searchfilters map<text,varchar>,primary key (id,tenantid, regionid, profileid,itemid));
CREATE INDEX if not exists sampletrendrecousereventsummaryeventrequired ON userevent (eventrequired);
CREATE INDEX if not exists sampletrendrecousereventsummarydate ON userevent (date);
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,eventrequired,date) values (C979CA35-B58D-434B-B2D6-EA0316BCC9A2,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'like',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,1,'2014-06-30'); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (0BA3ECD3-51A8-4B52-BDC0-00C628649B4D,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'0'},1,'2014-06-30',0); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (8EB93354-1B9E-4BB9-B87A-E113D02986F5,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'20'},1,'2014-06-30',20); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (B1758CC6-5E43-4C64-AA88-3A858F31580A,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'40'},1,'2014-06-30',40); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (D4AF16CB-693A-4C67-9942-354E285CA3A0,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'60'},1,'2014-06-30',60); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (9860C64E-628A-411E-8489-BD1E8DE1E793,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'80'},1,'2014-06-30',80); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (B526E86D-94DA-426C-B83B-7D5676F4FB1B,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404111596,{'watchperc':'100'},1,'2014-06-30',100);
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (BC0E9446-BF8D-4164-9E3F-2B7B11997A5F,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'0'},1,'2014-06-29',0); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (3A8EDA55-6A88-4020-9503-E9B8C16904AD,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'20'},1,'2014-06-29',20); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (6F618370-3B0E-48CF-881E-686607D078D9,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'40'},1,'2014-06-29',40); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (1E8174AD-5F6C-4E52-87E2-F881C8B9C835,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'60'},1,'2014-06-29',60); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (1F677B99-A52A-4465-8ACA-4F1929E090BC,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'80'},1,'2014-06-29',80); 
insert into userevent(id,tenantid,regionid,profileid, eventtype, itemid,timestamp,attributevaluepair,eventrequired,date,playpercentage) values (EC17BDCD-A6FA-467E-9199-904D7DDB970E,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A1,C979CA35-B58D-434B-B2D6-EA0316BCC9A8,'watch',C979CA35-B58D-434B-B2D6-EA0316BCC122,1404025196,{'watchperc':'100'},1,'2014-06-29',100); 
create table if not exists dailyeventsummaryperuseritem(periodid timeuuid ,tenantid uuid,regionid uuid,itemid uuid,profileid uuid,eventtypeaggregate  map<text,int>,dayscore double,date timestamp,eventrequired int,primary key (periodid,tenantid,regionid,itemid,profileid));